"use strict";defineM((function(t,e,i,a){function n(a,n,r){let s=e.isAMP(),d=t(e.getComponentHTML(a)),l=d.find(".item"),o=d.find(".modal .carousel-item"),c=s?d.find(".dots"):d.find(".carousel-indicators li"),m=d.find(".img-prw-wrapper"),p=d.find("amp-state").attr("id"),f=d.find("amp-carousel").attr("id"),h=n+1,g=n+1;"string"!=typeof r&&r?r.length>=1&&t(r).each((function(g){let u=l.eq(n).clone();if(s&&u.find("amp-img").attr("src",r[g]),u.find("img").attr("src",r[g]),u.insertAfter(l.eq(n)),c.eq(n).clone().insertAfter(c.eq(n)),u.is(".gallery-image")){let t=o.eq(n).clone();t.find("img").attr("src",r[g]),t.insertAfter(o.eq(n))}let v=m.eq(n).clone();if(v.find("img").attr("src",r[g]),v.insertAfter(o.eq(n)),r.length-1===g)if(l=d.find(".item"),o=d.find(".carousel-item"),c=s?d.find(".dots"):d.find(".carousel-indicators li"),m=d.find(".img-prw-wrapper"),l.each((function(e){s&&t(this).find("img").attr("data-slide-to",e)})),c.each((function(e){s?(t(this).find("dot").attr("data-amp-bind-class",p+".slide == "+h+' ? "current" : ""'),t(this).find("dot").attr("on","tap:"+f+".goToSlide(index="+h+")"),t(this).find("dot").removeClass("current")):t(this).attr("data-slide-to",e)})),s&&m.each((function(e){t(this).find("dot").attr("data-amp-bind-class",p+".slide == "+h+' ? "current" : ""'),t(this).find("dot").attr("on","tap:"+f+".goToSlide(index="+h+")"),t(this).find("dot").removeClass("current")})),e.setComponentHTML(a,d[0].outerHTML),r.length>1){let n=e.$template.find("[data-app-component-id="+a+"]").find("img"),r=0;n.each((function(){t(this).one("load",(function(){r++,e.progressBar("show",i("Loading Images"),"",!0),e.progressBar(r+" / "+n.length),e.progressBar({progress:100/n.length*r},"","",!0),r===n.length&&(e.progressBar("hide"),e.hidePreloader())}))}))}else e.hidePreloader()})):(l.each((function(e){if(n==e){let i=t(this).clone();r&&i.find("amp-img").attr("src",r),r&&i.find("img").attr("src",r),i.insertAfter(t(this)),s||i.find("img").attr("data-slide-to",++e)}else!s&&n<e&&t(l.find("img")[e]).attr("data-slide-to",++e)})),c.each((function(e){if(n==e){var i=t(this).clone();s?(i.find(".dot").attr("data-amp-bind-class",p+".slide == "+h+' ? "current" : ""'),i.find(".dot").attr("on","tap:"+f+".goToSlide(index="+h+")"),i.find(".dot").removeClass("current")):i.attr("data-slide-to",h),i.insertAfter(t(this))}else e>=n&&l.length>1&&(h++,s?(t(this).find(".dot").attr("data-amp-bind-class",p+".slide == "+h+' ? "current" : ""'),t(this).find(".dot").attr("on","tap:"+f+".goToSlide(index="+h+")")):t(this).attr("data-slide-to",h))})),o.each((function(e){if(n==e){let e=t(this).clone();r&&e.find("img").attr("src",r),e.insertAfter(t(this)),s||0!=n||e.removeClass("active")}})),e.isAMP()&&m.each((function(e){if(n==e){var i=t(this).clone();r&&i.find("amp-img").attr("src",r),r&&i.find("img").attr("src",r),i.find("amp-img").attr("data-amp-bind-class",p+".slide == "+g+'? "selected":""'),i.find("amp-img").attr("on","tap:"+f+".goToSlide(index="+g+")"),i.find("amp-img").attr("tabindex",e),i.find("amp-img").removeClass("selected"),i.insertAfter(t(this))}else e>=n&&l.length>1&&(g++,t(this).find("amp-img").attr("data-amp-bind-class",p+".slide == "+g+'? "selected":""'),t(this).find("amp-img").attr("on","tap:"+f+".goToSlide(index="+g+")"),t(this).find("amp-img").attr("tabindex",e))})),e.setComponentHTML(a,d[0].outerHTML))}function r(i,a){let n=t(e.getComponentHTML(i)),r=n.find(".item"),s=n.find(".modal .carousel-item"),d=n.find(".img-prw-wrapper");r.each((function(i){i==a?(a==r.length-1?t(this).insertBefore(r.first()):t(this).insertAfter(t(this).next()),a==r.length-1&&s&&!e.isAMP()?(t(s[i]).insertBefore(s.first()),s.first().removeClass("active"),s.last().addClass("active")):s&&!e.isAMP()&&t(s[i]).insertAfter(t(s[i]).next()),e.isAMP()||(t(r[a]).find("img").attr("data-slide-to",a+1),a!=r.length-1&&t(r[a+1]).find("img").attr("data-slide-to",a))):e.isAMP()||a!=r.length-1||t(r[i]).find("img").attr("data-slide-to",i)})),d.each((function(e){e==a&&(a==d.length-1?t(this).insertBefore(d.first()):t(this).insertAfter(t(this).next()))})),d.find("amp-img").each(((e,i)=>{t(i).attr("on",t(i).attr("on").replace(/\(index=\d+\)/,"(index="+e+")")),t(i).attr("data-amp-bind-class",t(i).attr("data-amp-bind-class").replace(/slide == \d+\?/,"slide == "+e+"?")),t(i).attr("tabindex",e)})),e.setComponentHTML(i,n[0].outerHTML)}function s(i,a){let n=t(e.getComponentHTML(i)),r=n.find(".item"),s=n.find(".modal .carousel-item"),d=n.find(".img-prw-wrapper");r.each((function(i){i==a?(0==a?t(this).insertAfter(r.last()):t(this).insertBefore(t(this).prev()),0==a&&s&&!e.isAMP()?t(s[i]).insertAfter(s.last()):s&&!e.isAMP()&&t(s[i]).insertBefore(t(s[i]).prev()),a<2&&s&&!e.isAMP()&&(s.first().removeClass("active"),t(s[1]).addClass("active")),e.isAMP()||(0!=a&&t(r[a]).find("img").attr("data-slide-to",a-1),t(r[a-1]).find("img").attr("data-slide-to",a))):e.isAMP()||0!=a||t(r[i]).find("img").attr("data-slide-to",i)})),d.each((function(e){e==a&&(0==a?t(this).insertAfter(d.last()):t(this).insertBefore(t(this).prev()))})),d.find("amp-img").each(((e,i)=>{t(i).attr("on",t(i).attr("on").replace(/\(index=\d+\)/,"(index="+e+")")),t(i).attr("data-amp-bind-class",t(i).attr("data-amp-bind-class").replace(/slide == \d+\?/,"slide == "+e+"?")),t(i).attr("tabindex",e)})),e.setComponentHTML(i,n[0].outerHTML)}function d(a,n){let r=t(e.getComponentHTML(a)),s=r.find(".item"),d=r.find(".modal .carousel-item"),l=r.find(".dots"),o=r.find(".img-prw-wrapper"),c=r.find("amp-state").attr("id"),m=r.find("amp-carousel").attr("id"),p=n+1,f=n+1;s.each((function(a){a==n&&s.length>1&&(t(this).remove(),e.isAMP()||(0==a&&t(d[1]).addClass("active"),t(d[a]).remove())),s.length<=1&&e.alertDlg(i("This element is the last. It cannot be removed."))})),e.isAMP()?l.each((function(e){e==n&&s.length>1?(t(this).remove(),p--):e>=n&&s.length>1&&(t(this).find(".dot").attr("data-amp-bind-class",c+".slide == "+p+' ? "current" : ""'),t(this).find(".dot").attr("on","tap:"+m+".goToSlide(index="+p+")"),p++)})):s.length>1&&r.find(".carousel-indicators li").last().remove(),o.each((function(e){e==n&&s.length>1?(t(this).remove(),f--):e>=n&&s.length>1&&(t(this).find("amp-img").attr("data-amp-bind-class",c+".slide == "+f+'? "selected":""'),t(this).find("amp-img").attr("on","tap:"+m+".goToSlide(index="+f+")"),t(this).find("amp-img").attr("tabindex",f),f++)})),e.setComponentHTML(a,r[0].outerHTML)}function l(l){if(t(l.currentTarget).is(".item")){let m,p=t(l.currentTarget).find(".item-wrapper"),h=t('<div class="item-menu-overlay">'),g=t(l.target).parents(".app-component").attr("data-app-component-id"),u=t('<div class="btn-wrapper">');t(l.currentTarget).parent().parent().find(".item").each((function(t){l.currentTarget==this&&(m=t)}));let v=t('<span class="mbr-icon-trash ctrl-btn"><span class="tooltiptext">'+i("Remove")+"</span></span>").click((t=>{t.stopPropagation(),t.preventDefault(),d(g,m)})),b=t('<span class="mbr-icon-plus ctrl-btn"><span class="tooltiptext">'+i("Add Copy")+"</span></span>").click((t=>{t.stopPropagation(),t.preventDefault(),n(g,m)})),x=t('<span class="mbr-icon-plus ctrl-btn"><span class="tooltiptext">'+i("Add Items")+"</span></span>").click((i=>{i.stopPropagation(),i.preventDefault(),function(i,a){t(e.getComponentHTML(i)).find(".item").each((function(r){if(a==r){let r=e.isAMP()?t(this).find("amp-img"):t(this).find("img"),s={image:{active:!0,alt:r.attr("alt"),src:r.attr("src"),width:r[0].naturalWidth}};e.showMediaImageDialog(s,(function(t){t.image?n(i,a,t.image.src):t.length>=1&&(t.reverse(),n(i,a,t))}),!1,!1,!0,i)}}))}(g,m)})),w=t('<span class="mbr-icon-arrow-right ctrl-btn"><span class="tooltiptext">'+i("Move Right")+"</span></span>").click((t=>{t.stopPropagation(),t.preventDefault(),r(g,m)})),A=t('<span class="mbr-icon-arrow-left ctrl-btn"><span class="tooltiptext">'+i("Move Left")+"</span></span>").click((t=>{t.stopPropagation(),t.preventDefault(),s(g,m)}));if(t(l.currentTarget).is(".item.shop-image")){let e=t('<span class="mbr-icon-pencil ctrl-btn"><span class="tooltiptext">'+i("Edit")+"</span></span>").click((t=>f(t,g,m)));h.append(u.append(e).append(A).append(w).append(v).append(b)),h.click((t=>f(t,g,m)))}t(l.currentTarget).is(".item.shop-image")&&t(l.currentTarget).find(".item-menu-overlay").click((t=>f(t,g,m))),t(l.currentTarget).is(".item.features-image")&&h.append(u.append(A).append(w).append(v).append(x)),t(l.currentTarget).is(".item.gallery-image")&&h.append(u.append(A).append(w).append(v).append(x)),t(l.currentTarget).is(".item.slider-image")&&h.click((n=>function(n){let r=e.getAddonDir(e.theme.name),s=t(e.getComponentHTML(n)).find("img").each((function(){0===t(this).attr("src").search("../../")?t(this).attr("src",t(this).attr("src").replace("../../","")):0===t(this).attr("src").search("../")?t(this).attr("src",a.path2app(r)+"/components"+t(this).attr("src").replace("..","")):t(this).attr("src",t(this).attr("src").replace(e.path2core(r),a.path2app(r)))})),d=t('<div class="row">'),l=t('<div class="col-md-4 item"><div class="item-wrapper"><img>');s.each((function(){let e=l.clone();e.find("img").attr("src",t(this).attr("src")),e.find("img").attr("data-text",t(this).find("span").html()),t(this).find("a")&&(e.find("img").attr("data-link",t(this).find("a").attr("href")),e.find("img").attr("data-window","target"==t(this).find("a").attr("target"))),t(this).attr("lightbox")&&e.find("img").attr("data-lb",t(this).attr("lightbox")),d.append(e)}));let m=e.showDialog({title:i("Slides"),size:"large",className:"note-air-layout item-wizard-slides",body:'<div class="gallery-wrapper">'+d[0].outerHTML,successLabel:"Ok",success:function(){}});c(m,n),o(m,n)}(g))),0===p.find(".item-menu-overlay").length&&p.append(h),h.fadeTo(200,1),t(l.currentTarget).one("mouseleave",(function(){h.fadeTo(200,0,(function(){t(h).remove()}))}))}}function o(e,i){let a,n=e.is("img")?e:t(e).find("img");n.on("click",(t=>{for(var e=0;e<n.length;e++)t.currentTarget==n[e]&&(a=e);m(t.currentTarget,!1,i,a,!0)}))}function c(a,n){let l;(t(a).is(".item-wrapper")?t(a):t(a).find(".item-wrapper")).on("mouseenter",(function(a){let o=t(a.currentTarget),c=t('<div class="item-menu-overlay">'),p=t('<div class="btn-wrapper">');o.parents(".row").find(".item").each((function(e,i){0!==t(i).has(o).length&&(l=e)}));let f=t('<span class="mbr-icon-trash ctrl-btn"><span class="tooltiptext">'+i("Remove")+"</span></span>").click((i=>function(i,a,n){let r=t(i.target).parents(".item");r.parent().find(".item").length<=1?e.alertDlg("This element is the last. It cannot be removed."):r.remove();d(a,n)}(i,n,l))),h=t('<span class="mbr-icon-plus ctrl-btn"><span class="tooltiptext">'+i("Add Items")+"</span></span>").click((t=>m(t.currentTarget,!0,n,l))),g=t('<span class="mbr-icon-arrow-right ctrl-btn"><span class="tooltiptext">'+i("Move Right")+"</span></span>").click((e=>function(e,i,a){let n=t(e.target).parents(".item"),s=t(e.target).parents().find(".item");s.each((function(t,e){n[0]==e&&(t==s.length-1?n.insertBefore(s.first()):n.insertAfter(n.next()))})),r(i,a)}(e,n,l))),u=t('<span class="mbr-icon-arrow-left ctrl-btn"><span class="tooltiptext">'+i("Move Left")+"</span></span>").click((e=>function(e,i,a){let n=t(e.target).parents(".item"),r=t(e.target).parents().find(".item");r.each((function(t,e){n[0]==e&&(0==t?n.insertAfter(r.last()):n.insertBefore(n.prev()))})),s(i,a)}(e,n,l)));c.append(p.append(u).append(g).append(f).append(h)),0==o.find(".item-menu-overlay").length&&o.append(c),c.fadeTo(200,1),o.one("mouseleave",(function(){c.fadeTo(200,0,(function(){t(c).remove()}))}))}))}function m(i,n,r,s,d){let l=t(i).parents(".item").find("img"),o={image:{active:!0,alt:l.attr("alt"),src:a.path2app(a.path2app(l.attr("src"))),width:l[0].naturalWidth}};t(i).attr("data-link")&&(o.image.link=t(i).attr("data-link"),o.image.linkInNewWindow=t(i).attr("data-window"),o.image.lightbox=!1),t(i).attr("data-lb")&&(o.image.lightbox=!0),e.showMediaImageDialog(o,(function(i){i.image?n?n&&p(l[0],i.image.src,r,s):function(i,a,n,r){let s=t(i).parents(".item");s.find("img").attr("src",a.image.src),a.image.link?(s.find("img").attr("data-link",a.image.link),s.find("img").attr("data-window",a.image.linkInNewWindow)):(s.find("img").removeAttr("data-link"),s.find("img").removeAttr("data-window"));a.image.lightbox?s.find("img").attr("data-lb",a.image.lightbox):s.find("img").removeAttr("data-lb");!function(i,a,n){let r=t(e.getComponentHTML(i)),s=r.find(".item"),d=r.find(".img-prw-wrapper");s.each((function(e){if(a==e){if(t(this).find("amp-img").attr("src",n.image.src),t(this).find("img").attr("src",n.image.src),n.image.link&&!n.image.lightbox)if(t(this).find("amp-img a").length)t(this).find("amp-img a").attr("href",n.image.link),t(this).find("amp-img a").attr("target",n.image.linkInNewWindow?"_target":"_self"),t(this).find("amp-img").removeAttr("lightbox"),t(this).find("amp-img img").removeAttr("lightbox");else{let e=t("<a>");e.attr("href",n.image.link),e.attr("target",n.image.linkInNewWindow),t(this).find("img").parent().append(e),e.append(t(this).find("img"))}else if(t(this).find("amp-img a").length){let e=t(this).find("amp-img a"),i=e.html();e.parent().append(i),e.remove()}n.image.lightbox?(t(this).find("amp-img").attr("lightbox",n.image.lightbox),t(this).find("img").attr("lightbox",n.image.lightbox)):(t(this).find("amp-img").removeAttr("lightbox"),t(this).find("img").removeAttr("lightbox"))}})),d.each((function(e){a==e&&(t(this).find("amp-img").attr("src",n.image.src),t(this).find("img.mbr-temp").attr("src",n.image.src))})),e.setComponentHTML(i,r[0].outerHTML)}(n,r,a)}(l[0],i,r,s):i.length>=1&&(i.reverse(),p(l[0],i,r,s))}),!1,!1,n,r,d)}function p(e,i,a,r){let s=t(e).parents(".item");if("string"==typeof i){let t=s.clone();t.find("img").attr("src",i),c(t,a),o(t.find("img")),t.find(".item-menu-overlay").remove(),t.insertAfter(s)}else if(i.length>=1){let e=[];t(i).each((function(t){let n=s.clone();n.find("img").attr("src",i[t]),c(n,a),o(n.find("img")),n.find(".item-menu-overlay").remove(),e.push(n)})),e.length&&s.after(e)}n(a,r,i)}function f(i,a,n){let r=t(i.currentTarget).parents(".item").parent().find("amp-lightbox");r.each((function(e){e==n&&(t(this).removeAttr("hidden"),t(this).find("div.placeholder").attr("hidden",!0))})),r.find(".close").click((function(i){let s=t(e.getComponentHTML(a)),d=s.find("amp-lightbox"),l=s.find(".item-wrapper amp-img"),o=s.find(".item-wrapper");d.each((function(e,i){l.each((function(a){if(n==e&&e==a){var r=t(i).find("amp-img img.mbr-temp")[0].naturalHeight,s=t(i).find("amp-img img.mbr-temp")[0].naturalWidth;r&&s||(r=9,s=16),t(this).attr("src",t(i).find("amp-img img").attr("src")),t(this).attr("alt",t(i).find("amp-img").attr("alt")),t(this).attr("height",r),t(this).attr("width",s),t(this).find("img").attr("src",t(i).find("amp-img img").attr("src"))}})),o.each((function(a){n==e&&e==a&&(t(this).find(".item-title").html(t(i).find(".item-box-title").html()),t(this).find(".cur").html(t(i).find(".cur").html()),t(this).find(".item-price").html(t(i).find(".item-box-price").html()),t(this).find(".item-text").html(t(i).find(".item-box-text").html()),t(this).find("a.btn").html(t(i).find("a.btn").html()),t(i).find("a.btn").attr("href")&&t(this).find("a.btn").attr("href",t(i).find("a.btn").attr("href")))}))})),r.attr("hidden",!0),r.find("div.placeholder").removeAttr("hidden"),e.setComponentHTML(a,s[0].outerHTML)}))}e.addCoreResource("./app/includes/item-wizard.css"),e.addAppResource("./app/includes/item-wizard.css"),e.regExtension({name:"item-wizard",events:{load:function(){navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?e.$template.on("touchstart",".item",(function(t){t.stopPropagation(),t.preventDefault(),l(t)})):e.$template.on("mouseenter",".item",(function(t){t.stopPropagation(),t.preventDefault(),l(t)})),e.Core.on("loadedComponent",(function(i,n,r,s){if(e.isAMP()){var d=t(r).find("[data-app-component-id="+i._id+"]"),l=d.find(".dots-wrapper span");for(let e=0;e<l.length;e++)t(l[e]).on("click",(function(e){d.find(".i-amphtml-slide-item");var i=d.find(".amp-lightbox-carousel amp-carousel .i-amphtml-slides-container > div");i.each((function(){t(this).addClass("hidden-slide").removeClass("visible-slide")}));var a=l.index(e.target);t(i[a]).addClass("visible-slide").removeClass("hidden-slide"),l.each((function(e){t(this).removeClass("current")})),t(this).addClass("current")}));var o=d.find(".amp-lightbox-carousel amp-carousel .amp-carousel-button-next"),c=d.find(".amp-lightbox-carousel amp-carousel .amp-carousel-button-prev");o.click((e=>{let i=d.find(".i-amphtml-slide-item"),a=i.length,n=d.find(".dot"),r=d.find(".preview-wrapper amp-img");for(i.each(((e,i)=>{t(i).is(".visible-slide, .hidden-slide")&&t(i).removeClass("visible-slide").removeClass("hidden-slide");let n=t(i).attr("style").replace(/\d/,(function(t){return t=parseInt(t,10)+1}));parseInt(n.match(/\d/),10)>a?n=1:parseInt(n.match(/\d/),10)<1&&(n=a),t(this).attr("style",n)})),r.each(((e,i)=>{t(i).removeClass("selected")})),n.each(((e,i)=>{t(i).removeClass("current")})),f=0;f<a;f++)if(t(i[f]).find('[aria-hidden="false"]').length){let e=1;e=f+2>a?1:f+2,t(n[e-1]).addClass("current"),t(r[e-1]).addClass("selected")}})),c.click((e=>{let i=d.find(".i-amphtml-slide-item"),a=i.length,n=d.find(".dot"),r=d.find(".preview-wrapper amp-img");for(i.each(((e,i)=>{t(i).is(".visible-slide, .hidden-slide")&&t(i).removeClass("visible-slide").removeClass("hidden-slide");let n=t(i).attr("style").replace(/\d/,(function(t){return t=parseInt(t,10)-1}));parseInt(n.match(/\d/),10)>a?n=1:parseInt(n.match(/\d/),10)<1&&(n=a),t(this).attr("style",n)})),r.each(((e,i)=>{t(i).removeClass("selected")})),n.each(((e,i)=>{t(i).removeClass("current")})),f=0;f<i.length;f++)if(t(i[f]).find('[aria-hidden="false"]').length){let e=1;e=f-1<0?i.length:f,t(n[e-1]).addClass("current"),t(r[e-1]).addClass("selected")}}));for(var m=d.find(".preview-wrapper amp-img"),p=d.find(".i-amphtml-slide-item"),f=0;f<m.length;f++)t(m[f]).on("click",(function(e){p.each(((e,i)=>{t(i).is(".visible-slide, .hidden-slide")&&t(i).removeClass("visible-slide").removeClass("hidden-slide")})),m.each((function(){t(this).removeClass("selected")})),t(this).addClass("selected")}))}if(s)if(e.isAMP())r.find("section .amp-shop").each((function(e){t(this).find(".item").each((function(i){let a=/\:((.*?)(?:-(\d)-(\d))?)(?:$|\.)/,n=(t(this).attr("on").match(a)[1],t(this).attr("on").match(a)[2]);t(this).attr("on","tap:"+n+"-"+e+"-"+i),t(this).find("amp-lightbox").attr("id",n+"-"+e+"-"+i),t(this).find("button.close").attr("on","tap:"+n+"-"+e+"-"+i+".close")}))})),r.find("section.amp-lightbox-carousel").each((function(e,i){t(i).find("amp-carousel").find(".img-prw-wrapper amp-img").each((function(e){t(this).attr("data-amp-bind-class",t(this).attr("data-amp-bind-class").replace(/== \d+ \?|==\d+\?/gm,"== "+e+" ?")),t(this).attr("tabindex",e),t(this).attr("on",t(this).attr("on").replace(/index=\d+/gm,"index="+e))}))}));else{let i=r.find("section .mbr-gallery").parent();i.length&&i.each(((i,n)=>{e.getUID(3,{timePrefix:!0}),e.getUID(3,{timePrefix:!0});let r=[];t(n).find(".row img").each(((e,i)=>{t(i).attr("data-slide-to",e);let n=0===i.src.indexOf(a.base)?i.src.replace(a.base,"../../"):i.src;r.push(n)})),t(n).find(".carousel img").each(((e,i)=>{t(i).attr("src",r.shift())})),t(n).find(".carousel li").each(((e,i)=>{t(i).attr("data-slide-to",e)}))}))}}))}}})}),["jQuery","mbrApp","TR()","Bridge"]);