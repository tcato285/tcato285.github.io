!function(){"use strict";var e,t,i="function"==typeof jQuery;i&&(e=jQuery),t=e?e("html").hasClass("is-builder"):document.querySelector("html").classList.contains("is-builder");var a,s=(a={},function(t){var i=e.Deferred();return t in a?a[t]?i.resolve(a[t]):i.reject("Preview image not found."):e("<img>").on("load",(function(){if(120===(this.naturalWidth||this.width)){var e=this.src.split("/").pop();switch(e){case"maxresdefault.jpg":this.src=this.src.replace(e,"sddefault.jpg");break;case"sddefault.jpg":this.src=this.src.replace(e,"hqdefault.jpg");break;case"hqdefault.jpg":this.src=this.src.replace(e,"default.jpg");break;default:a[t]=null,i.reject("Preview image not found.")}}else i.resolve(a[t]=this.src)})).attr("src","https://img.youtube.com/vi/"+t+"/maxresdefault.jpg"),i});t&&i&&(e.fn.outerFind=function(e){return this.find(e).addBack(e)},e(document).on("add.cards",(function(t){if(e(t.target).hasClass("carousel")){var i=e("html").hasClass("desktop");e(t.target).outerFind("[data-bg-video-slide]").each((function(){var t=function(e){if("false"===e)return!1;var t=e.match(/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(&\S+)?/);return!!t&&t[6]}(e(this).attr("data-bg-video-slide"));if(t){var a=e('<div class="mbr-background-video-preview"></div>').css({display:"none",backgroundSize:"cover",backgroundPosition:"center"});e(".container-slide",this).before(a);var r,o,c,n=function(e){if("false"===e)return!1;var t=e.match(/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(&\S+)?/);return t&&/youtu\.?be/g.test(t[3])?"youtube":!(!t||!/vimeo/g.test(t[3]))&&"vimeo"}(e(this).attr("data-bg-video-slide")),l=e(this).find(".mbr-overlay");if("youtube"===n)s(t).done((function(e){a.css("background-image",'url("'+e+'")').show()})),i&&e.fn.YTPlayer&&!e(this).find(".playerBox").length&&(e(".container-slide",this).before('<div class="mbr-background-video"></div>').prev().YTPlayer({videoURL:t,containment:"self",showControls:!1,mute:!0}),l.length&&e(".YTPOverlay",this).css({opacity:l.css("opacity"),backgroundColor:l.css("background-color")}),e(this).find(".image_wrapper img").css("opacity","0"),e(this).find(".image_wrapper .mbr-overlay").css("opacity","0"));else if(r=t,o=function(e){a.css("background-image",'url("'+e+'")').show()},(c=new XMLHttpRequest).open("GET","https://vimeo.com/api/v2/video/"+r+".json",!0),c.onreadystatechange=function(){if(4===this.readyState&&this.status>=200&&this.status<400){var e=JSON.parse(this.responseText);o(e[0].thumbnail_large)}},c.send(),c=null,i&&e.fn.vimeo_player&&!e(this).find(".playerBox").length){var u=e(".container-slide",this).before('<div class="mbr-background-video"></div>').prev();new Vimeo.Player(u);l.length&&e(".vimeo_player_overlay",this).css({opacity:l.css("opacity"),backgroundColor:l.css("background-color")})}}})),e(t.target).find(".carousel-item iframe").css({transitionProperty:"opacity",transitionDuration:"1000ms"}),e(this).on("slide.bs.carousel","section.carousel",(function(t){e(t.target).find(".carousel-item.active .mb_YTPlayer").each((function(){e(this).YTPPause()})),e(t.target).find(".carousel-item.active .vimeo_player").each((function(){e(this).v_pause()})),e(t.target).find(".carousel-item:not(.active) iframe").css("opacity",0)})),e(this).on("slid.bs.carousel","section.carousel",(function(t){e(t.target).find(".carousel-item.active .mb_YTPlayer").each((function(){e(this).YTPPlay()})),e(t.target).find(".carousel-item.active .vimeo_player").each((function(){e(this).v_play()})),e(t.target).find(".carousel-item.active iframe").resize().css("opacity",1)}))}})))}();